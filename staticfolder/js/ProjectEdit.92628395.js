(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ProjectEdit"],{"159b":function(t,e,r){var a=r("da84"),i=r("fdbc"),n=r("17c2"),o=r("9112");for(var s in i){var c=a[s],u=c&&c.prototype;if(u&&u.forEach!==n)try{o(u,"forEach",n)}catch(d){u.forEach=n}}},"17c2":function(t,e,r){"use strict";var a=r("b727").forEach,i=r("a640"),n=i("forEach");t.exports=n?[].forEach:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}},2532:function(t,e,r){"use strict";var a=r("23e7"),i=r("5a34"),n=r("1d80"),o=r("ab13");a({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(n(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,e,r){var a=r("861d"),i=r("c6b6"),n=r("b622"),o=n("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},"4bd4":function(t,e,r){"use strict";var a=r("58df"),i=r("7e2b"),n=r("3206");e["a"]=Object(a["a"])(i["a"],Object(n["b"])("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(t){const e=Object.values(t).includes(!0);this.$emit("input",!e)},deep:!0,immediate:!0}},methods:{watchInput(t){const e=t=>t.$watch("hasError",e=>{this.$set(this.errorBag,t._uid,e)},{immediate:!0}),r={_uid:t._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?r.shouldValidate=t.$watch("shouldValidate",a=>{a&&(this.errorBag.hasOwnProperty(t._uid)||(r.valid=e(t)))}):r.valid=e(t),r},validate(){return 0===this.inputs.filter(t=>!t.validate(!0)).length},reset(){this.inputs.forEach(t=>t.reset()),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout(()=>{this.errorBag={}},0)},resetValidation(){this.inputs.forEach(t=>t.resetValidation()),this.resetErrorBag()},register(t){this.inputs.push(t),this.watchers.push(this.watchInput(t))},unregister(t){const e=this.inputs.find(e=>e._uid===t._uid);if(!e)return;const r=this.watchers.find(t=>t._uid===e._uid);r&&(r.valid(),r.shouldValidate()),this.watchers=this.watchers.filter(t=>t._uid!==e._uid),this.inputs=this.inputs.filter(t=>t._uid!==e._uid),this.$delete(this.errorBag,e._uid)}},render(t){return t("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:t=>this.$emit("submit",t)}},this.$slots.default)}})},"5a34":function(t,e,r){var a=r("44e7");t.exports=function(t){if(a(t))throw TypeError("The method doesn't accept regular expressions");return t}},"8ce9":function(t,e,r){},a640:function(t,e,r){"use strict";var a=r("d039");t.exports=function(t,e){var r=[][t];return!!r&&a((function(){r.call(null,e||function(){throw 1},1)}))}},ab13:function(t,e,r){var a=r("b622"),i=a("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[i]=!1,"/./"[t](e)}catch(a){}}return!1}},b011:function(t,e,r){"use strict";r.d(e,"a",(function(){return d}));var a=r("b85c"),i=r("1da1"),n=r("d4ec"),o=r("bee2"),s=r("ade3"),c=(r("a4d3"),r("e01a"),r("ac1f"),r("5319"),r("fb6a"),r("96cf"),r("f532")),u=r("0613"),d=function(){function t(){Object(n["a"])(this,t),Object(s["a"])(this,"readMoreGuard","---readmore---")}return Object(o["a"])(t,[{key:"getAllSections",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,r,a=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]&&a[0],t.next=3,Object(c["a"])("api/section/");case 3:return r=t.sent,e||this.cutTextAfterReadMore(r.data),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getSection",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r,a,i,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=!(n.length>1&&void 0!==n[1])||n[1],t.next=3,Object(c["a"])("api/section/"+e);case 3:return a=t.sent,r&&(i=a.data.description.indexOf(this.readMoreGuard),-1!==i&&(a.data.description=a.data.description.replace(this.readMoreGuard,""))),t.abrupt("return",a);case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"editSection",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].patch("api/section/"+e+"/",r,{headers:{Authorization:"Bearer "+u["a"].getters.token}});case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)})));function e(e,r){return t.apply(this,arguments)}return e}()},{key:"addSection",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].post("api/section/",e,{headers:{Authorization:"Bearer "+u["a"].getters.token}});case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"deleteSection",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].delete("api/section/"+e+"/",{headers:{Authorization:"Bearer "+u["a"].getters.token}});case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"cutTextAfterReadMore",value:function(t){var e,r=Object(a["a"])(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,n=i.description.indexOf(this.readMoreGuard);-1!==n&&(i.description=i.description.slice(0,n),i.readMore=!0)}}catch(o){r.e(o)}finally{r.f()}}}]),t}()},caad:function(t,e,r){"use strict";var a=r("23e7"),i=r("4d64").includes,n=r("44d2");a({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")},ce7e:function(t,e,r){"use strict";r("8ce9");var a=r("7560");e["a"]=a["a"].extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render(t){let e;return this.$attrs.role&&"separator"!==this.$attrs.role||(e=this.vertical?"vertical":"horizontal"),t("hr",{class:{"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical,...this.themeClasses},attrs:{role:"separator","aria-orientation":e,...this.$attrs},on:this.$listeners})}})},d81d:function(t,e,r){"use strict";var a=r("23e7"),i=r("b727").map,n=r("1dde"),o=n("map");a({target:"Array",proto:!0,forced:!o},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},e958:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("p",{staticClass:"text-h4 text-center font-weight-bold justify-center ma-2",staticStyle:{"word-break":"break-word"}},[t._v(" "+t._s(t.add?"Nowy projekt":"Edycja projektu nr "+this.$route.params.id)+" ")]),t.project?r("project-editor",{on:{validation:function(e){t.inputValidated=e}},model:{value:t.project,callback:function(e){t.project=e},expression:"project"}}):t._e(),t.add?r("editor-menu",{attrs:{text:"Czy na pewno chcesz opuścić ekran tworzenia nowego projektu bez zapisywania zmian?",saveText:"Dodaj projekt",discardText:"Odrzuć projekt"},on:{saveChanges:t.addProject,discardChanges:t.returnFromEditor}}):r("editor-menu",{attrs:{text:"Czy na pewno chcesz wyjść z edycji projektu bez zapisywania zmian?"},on:{saveChanges:t.editProject,discardChanges:t.returnFromEditor}})],1)},i=[],n=r("d4ec"),o=r("bee2"),s=r("257e"),c=r("262e"),u=r("2caf"),d=r("ade3"),l=(r("99af"),r("caad"),r("2532"),r("ac1f"),r("5319"),r("d81d"),r("9ab4")),h=r("1b40"),p=r("ce46"),v=function t(){Object(n["a"])(this,t),Object(d["a"])(this,"id",void 0),Object(d["a"])(this,"title",void 0),Object(d["a"])(this,"text",void 0),Object(d["a"])(this,"creation_date",void 0),Object(d["a"])(this,"publication_date",void 0),Object(d["a"])(this,"repository_link",void 0),Object(d["a"])(this,"gallery",void 0),Object(d["a"])(this,"creator",void 0),Object(d["a"])(this,"authors",void 0),Object(d["a"])(this,"section",void 0),Object(d["a"])(this,"readMore",void 0)},f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{staticClass:"ma-2",attrs:{outlined:""}},[r("v-card-text",[t.Project.creation_date&&t.Project.publication_date?r("v-row",{attrs:{"no-gutters":"",justify:"space-around"}},[r("v-col",{attrs:{cols:"12",sm:"auto"}},[r("p",[t._v(" Data utworzenia: "+t._s(t._f("moment")(t.Project.creation_date,"DD.MM.YYYY hh:mm:ss"))+" ")])]),r("v-col",{attrs:{cols:"12",sm:"auto"}},[r("p",[t._v(" Data publikacji: "+t._s(t._f("moment")(t.Project.publication_date,"DD.MM.YYYY hh:mm:ss"))+" ")])])],1):t._e(),r("v-divider"),r("v-form",{model:{value:t.inputValidated,callback:function(e){t.inputValidated=e},expression:"inputValidated"}},[r("v-text-field",{attrs:{clearable:"",label:"Tytuł projektu",rules:[t.required]},model:{value:t.Project.title,callback:function(e){t.$set(t.Project,"title",e)},expression:"Project.title"}}),r("element-selector",{attrs:{items:t.users,itemtext:"fullname",rules:"true",label:"Wyszukaj i wybierz autorów"},model:{value:t.Project.authors,callback:function(e){t.$set(t.Project,"authors",e)},expression:"Project.authors"}}),r("element-selector",{attrs:{items:t.sections,itemtext:"name",rules:"true",label:"Wybierz sekcję",multiple:!1},model:{value:t.Project.section,callback:function(e){t.$set(t.Project,"section",e)},expression:"Project.section"}}),r("link-list-input",{model:{value:t.Project.links,callback:function(e){t.$set(t.Project,"links",e)},expression:"Project.links"}}),r("markdown-editor",{attrs:{rules:"true",label:"Treść opisu projektu"},model:{value:t.Project.text,callback:function(e){t.$set(t.Project,"text",e)},expression:"Project.text"}})],1)],1),r("v-divider"),r("v-card-text",[r("gallery-editor",{model:{value:t.Project.gallery,callback:function(e){t.$set(t.Project,"gallery",e)},expression:"Project.gallery"}})],1)],1)},j=[],b=(r("159b"),r("b011")),m=r("f532"),g=function(t){Object(c["a"])(r,t);var e=Object(u["a"])(r);function r(){var t;Object(n["a"])(this,r);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Object(d["a"])(Object(s["a"])(t),"value",void 0),Object(d["a"])(Object(s["a"])(t),"sectionsService",void 0),t}return Object(o["a"])(r,[{key:"created",value:function(){this.sectionsService=new b["a"],this.getAllusers(),this.getAllSections(),this.cleanData()}},{key:"Project",get:function(){return this.value},set:function(t){this.$emit("input",t)}},{key:"getAllusers",value:function(){var t=this;m["a"].get("api/users/",{headers:{Authorization:"Bearer "+this.$store.getters.token}}).then((function(e){t.$data.users=e.data,t.$data.users.forEach((function(t){t.fullname=t.first_name+' "'+t.username+'" '+t.last_name}))}))}},{key:"getAllSections",value:function(){var t=this;this.sectionsService.getAllSections().then((function(e){t.$data.sections=e.data}))}},{key:"cleanData",value:function(){void 0!==this.Project.authors&&(this.Project.authors=this.Project.authors.map((function(t){return t.id}))),void 0!==this.Project.section&&(this.Project.section=this.Project.section.id),void 0===this.Project.gallery&&(this.Project.gallery=[])}},{key:"validationchanged",value:function(){this.$emit("validation",this.$data.inputValidated)}},{key:"data",value:function(){return{inputValidated:!1,users:[],sections:[],required:function(t){return!!t||"Pole wymagane"}}}}]),r}(h["c"]);Object(l["a"])([Object(h["b"])({required:!0})],g.prototype,"value",void 0),Object(l["a"])([Object(h["d"])("$data.inputValidated")],g.prototype,"validationchanged",null),g=Object(l["a"])([h["a"]],g);var y=g,k=y,w=r("2877"),$=r("6544"),x=r.n($),O=r("b0af"),P=r("99d9"),_=r("62ad"),z=r("ce7e"),V=r("4bd4"),E=r("0fd9"),B=r("8654"),M=Object(w["a"])(k,f,j,!1,null,null,null),S=M.exports;x()(M,{VCard:O["a"],VCardText:P["c"],VCol:_["a"],VDivider:z["a"],VForm:V["a"],VRow:E["a"],VTextField:B["a"]});var A=function(t){Object(c["a"])(r,t);var e=Object(u["a"])(r);function r(){var t;Object(n["a"])(this,r);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Object(d["a"])(Object(s["a"])(t),"projectsService",void 0),t}return Object(o["a"])(r,[{key:"created",value:function(){this.projectsService=new p["a"],this.$route.path.includes("add")?(this.$data.add=!0,this.$data.project=new v):this.getProject()}},{key:"getProject",value:function(){var t=this;void 0!==this.$route.params.id?this.projectsService.getProject(+this.$route.params.id,!1).then((function(e){t.$data.project=e})).catch((function(){t.$store.dispatch("errorMessage","Wystąpił błąd przy pobieraniu projektu!"),t.$router.replace({name:"projects"})})):this.$router.replace({name:"error404"})}},{key:"addProject",value:function(){var t=this;this.$data.inputValidated?this.projectsService.addProject({title:this.$data.project.title,authors:this.$data.project.authors,text:this.$data.project.text,section:this.$data.project.section,creator:this.$store.getters.user.id,repository_links:this.$data.project.links,gallery:this.$data.project.gallery.map((function(t){return t.id})),creation_date:new Date,publication_date:new Date}).then((function(e){201===e.status&&(t.$store.dispatch("successMessage","Projekt został dodany"),t.$router.replace({name:"project",params:{id:e.data.id}}))})).catch((function(){t.$store.dispatch("errorMessage","Błąd poczas zapisywania projektu!")})):this.$store.dispatch("warningMessage","Formularz nie zostal poprawnie wypełniony!")}},{key:"editProject",value:function(){var t=this;this.$data.inputValidated?this.projectsService.editProject(this.$data.project.id,{title:this.$data.project.title,authors:this.$data.project.authors,text:this.$data.project.text,section:this.$data.project.section,repository_links:this.$data.project.links,gallery:this.$data.project.gallery.map((function(t){return t.id}))}).then((function(e){200===e.status&&(t.$store.dispatch("successMessage","Projekt został zaktualizowany"),t.returnFromEditor())})).catch((function(){t.$store.dispatch("errorMessage","Błąd poczas edycji projektu!")})):this.$store.dispatch("warningMessage","Formularz nie został poprawnie wypełniony!")}},{key:"returnFromEditor",value:function(){this.$data.add?this.$router.replace({name:"projects",params:{page:"1"}}):this.$router.replace({name:"project",params:{id:this.$data.project.id}})}},{key:"data",value:function(){return{inputValidated:!1,project:void 0,add:!1}}}]),r}(h["c"]);A=Object(l["a"])([Object(h["a"])({components:{ProjectEditor:S}})],A);var R=A,C=R,D=Object(w["a"])(C,a,i,!1,null,null,null);e["default"]=D.exports}}]);